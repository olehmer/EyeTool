(function(t){function i(i){for(var s,o,r=i[0],l=i[1],c=i[2],h=0,u=[];h<r.length;h++)o=r[h],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(i);while(u.length)u.shift()();return a.push.apply(a,c||[]),e()}function e(){for(var t,i=0;i<a.length;i++){for(var e=a[i],s=!0,r=1;r<e.length;r++){var l=e[r];0!==n[l]&&(s=!1)}s&&(a.splice(i--,1),t=o(o.s=e[0]))}return t}var s={},n={app:0},a=[];function o(i){if(s[i])return s[i].exports;var e=s[i]={i:i,l:!1,exports:{}};return t[i].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=t,o.c=s,o.d=function(t,i,e){o.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,i){if(1&i&&(t=o(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)o.d(e,s,function(i){return t[i]}.bind(null,s));return e},o.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(i,"a",i),i},o.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},o.p="/eyetool/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=i,r=r.slice();for(var c=0;c<r.length;c++)i(r[c]);var d=l;a.push([0,"chunk-vendors"]),e()})({0:function(t,i,e){t.exports=e("56d7")},"0091":function(t,i,e){"use strict";e("c6cb")},"01d4":function(t,i,e){},"034f":function(t,i,e){"use strict";e("85ec")},"184c":function(t,i,e){"use strict";e("e34b")},"25ea":function(t,i,e){},"29f2":function(t,i,e){"use strict";e("62c6")},"3e65":function(t,i,e){"use strict";e("25ea")},"56d7":function(t,i,e){"use strict";e.r(i);e("e260"),e("e6cf"),e("cca6"),e("a79d");var s=e("2b0e"),n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"app"}},[e("Home")],1)},a=[],o=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"container"},[t.calibrating?t._e():e("div",{staticClass:"home"},[e("h3",[t._v("Data")]),e("div",{staticClass:"button top-left",on:{click:function(i){t.calibrating=!0}}},[t._v(" "+t._s(t.calibrated?"Recalibrate":"Calibrate")+" ")]),t.calibrated?t._e():e("div",{staticClass:"needs-cal"},[e("p",[t._v('You must calibrate this device before you can make measurements. Use the "Calibrate" button in the top left corner of the screen. The calibration will be stored locally (via cookies) on your device for future use. You can recalibrate at any time using the same button. ')])]),t.calibrated?e("div",{staticClass:"data-holder"},[e("div",{staticClass:"button",on:{click:t.addDataEntry}},[t._v("Add Data Entry")]),e("div",{staticClass:"table-holder"},t._l(t.dataReversed,(function(i,s){return e("div",{key:s,staticClass:"table-row",class:{odd:(s+1)%2},on:{click:function(i){return t.showDataDetails(t.data.length-1-s)}}},[e("p",[t._v(t._s(i.name))])])})),0)]):t._e(),e("div",{staticClass:"button top-right",on:{click:t.downloadData}},[t._v("Download Data")])]),t.calibrating?e("Calibrate",{attrs:{ppiIn:t.ppi,colorsIn:t.colors,sizeIn:t.size,distIn:t.dist,unitsIn:t.units},on:{setPPI:function(i){t.ppi=parseFloat(i)},setColors:function(i){t.colors=i},setSize:function(i){t.size=parseInt(i)},setDistance:function(i){t.dist=parseFloat(i)},setUnits:function(i){t.units=i},calibrationDone:function(i){return t.calibrationEnded()}}}):t._e(),t.dataDetails?e("DataDetails",{staticClass:"data-details-container",attrs:{dataIn:t.currentData,ppi:t.ppi,sizeIn:t.size,colorsIn:t.colors,distIn:t.dist,unitsIn:t.units},on:{deleteEntry:t.deleteCurrentEntry,closeDetailView:function(i){t.dataDetails=!1}}}):t._e()],1)},r=[],l=(e("a434"),e("b0c0"),e("ac1f"),e("843c"),e("1276"),e("2909")),c=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"content-view"},[e("h3",[t._v("Calibration (step "+t._s(t.view)+" of 3)")]),t.view>1?e("div",{staticClass:"button top-left",on:{click:function(i){t.view--}}},[t._v("Back")]):t._e(),t.canContinue()?e("div",{staticClass:"button top-right",on:{click:function(i){t.view<3?t.view++:t.calibrationDone()}}},[t._v(" "+t._s(3==t.view?"Done":"Next")+" ")]):t._e(),1==t.view?e("PPI",{attrs:{ppiIn:t.ppiIn},on:{setPPI:function(i){return t.updatePPI(i)}}}):t._e(),2==t.view?e("Colors",{attrs:{colorsIn:t.colors,sizeIn:t.size},on:{setColors:function(i){return t.updateColors(i)},setSize:function(i){return t.updateSize(i)}}}):t._e(),3==t.view?e("Distance",{attrs:{distIn:t.dist,unitsIn:t.units},on:{setDistance:function(i){return t.updateDist(i)},setUnits:function(i){return t.updateUnits(i)}}}):t._e()],1)},d=[],h=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"container"},[e("h3",[t._v("Set the Screen Pixel Density")]),e("h3",{staticClass:"selector",class:{active:0==t.method},on:{click:function(i){return t.setMethod(0)}}},[t._v("Enter PPI")]),e("h3",{staticClass:"selector",class:{active:1==t.method},on:{click:function(i){return t.setMethod(1)}}},[t._v("Manually Measure")]),e("canvas",{attrs:{id:"canvas_ppi"}},[t._v(" Your browser doesn't support HTML canvas. Please upgrade to a newer browser. ")]),0==t.method?e("div",{staticClass:"method"},[e("p",[t._v("The pixels per inch (PPI) of the screen is:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ppi,expression:"ppi"}],attrs:{placeholder:"pixels per inch"},domProps:{value:t.ppi},on:{input:[function(i){i.target.composing||(t.ppi=i.target.value)},t.updateWidth]}}),e("span",{staticStyle:{"padding-left":"10px"}},[t._v("PPI.")]),e("p",[t._v('If the PPI is correct, the red line above should measure exactly 25.4 mm (1 inch) in width. Note that mobile phones may require you to enter the dots per inch (DPI) instead of PPI. A common PPI for 1080p computer screens is 96. If you\'re unsure, click "Manually Measure" above to manually calibrate.')])]):t._e(),1==t.method?e("div",{staticClass:"method"},[e("p",[t._v("Using a ruler, the green line above is: ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.line_width,expression:"line_width"}],attrs:{placeholder:"line width in mm"},domProps:{value:t.line_width},on:{input:[function(i){i.target.composing||(t.line_width=i.target.value)},t.updatePPI]}}),e("span",{staticStyle:{"padding-left":"10px"}},[t._v("millimeters wide.")]),e("p",[t._v("From your measurement, the PPI/DPI of your screen is: "+t._s(t.ppi))])]):t._e()])},u=[],p={props:["ppiIn"],data:function(){return{canvas:null,ctx:null,ppi:null,ppi_default:96,line_width:null,method:0}},mounted:function(){this.ppi=this.ppiIn,this.setupCanvas(),this.init()},methods:{setMethod:function(t){this.method=t,this.setupCanvas(),this.init()},setupCanvas:function(){this.canvas=document.getElementById("canvas_ppi"),window.onresize=this.init,this.ctx=this.canvas.getContext("2d")},init:function(){this.ctx.canvas.width=window.innerWidth,this.ctx.canvas.height=20;var t=1==this.method?"green":"red",i=0;i=null===this.ppi||1==this.method?this.ppi_default:parseInt(this.ppi);var e={};e.x=this.ctx.canvas.width/2-i/2,e.y=this.ctx.canvas.height/2,this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(e.x+i,e.y),this.ctx.strokeStyle=t,this.ctx.lineWidth=5,this.ctx.stroke()},updateWidth:function(){this.init(),this.$emit("setPPI",this.ppi)},updatePPI:function(){this.line_width>0?this.ppi=Math.round(this.ppi_default/this.line_width*25.4):this.ppi=null,this.$emit("setPPI",this.ppi)}}},v=p,f=(e("3e65"),e("2877")),m=Object(f["a"])(v,h,u,!1,null,"2097905a",null),g=m.exports,_=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"container"},[e("h3",[t._v("Adjust Colors and Size for Your Glasses and Screen")]),e("canvas",{attrs:{id:"canvas_color"}},[t._v(" Your browser doesn't support HTML canvas. Please upgrade to a newer browser. ")]),e("div",[e("div",{staticClass:"slide-cont"},[e("p",[t._v("Set the size of the circles:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.size,expression:"size"}],attrs:{type:"range",min:"10",max:"200"},domProps:{value:t.size},on:{input:function(i){return t.drawCircles()},__r:function(i){t.size=i.target.value}}})])]),t._l(t.colors,(function(i,s){return e("div",{key:s,staticClass:"slide-cont"},[e("h3",[t._v(t._s(0==s?"Green":"Red")+" Circle RGB")]),t._l(3,(function(s){return e("div",{key:s},[e("p",[t._v(t._s(t.colorNames[s-1])+" Component:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i[s-1],expression:"color[j-1]"}],staticClass:"slider",attrs:{type:"range",min:"0",max:"255"},domProps:{value:i[s-1]},on:{input:function(i){return t.drawCircles()},__r:function(e){return t.$set(i,s-1,e.target.value)}}})])}))],2)})),e("div",{staticStyle:{height:"30px",width:"100%"}})],2)},w=[],x=(e("99af"),{props:["colorsIn","sizeIn"],data:function(){return{canvas:null,ctx:null,colors:[[0,128,0],[128,0,0]],colorNames:["Red","Green","Blue"],size:105}},mounted:function(){this.colors=this.colorsIn,null!==this.sizeIn&&(this.size=this.sizeIn),this.setupCanvas()},methods:{setupCanvas:function(){window.onresize=this.setupCanvas,this.canvas=document.getElementById("canvas_color"),this.ctx=this.canvas.getContext("2d");var t=window.innerWidth-20;t>500&&(t=window.innerWidth/2),this.ctx.canvas.width=t,this.ctx.canvas.height=.625*t,this.ctx.globalCompositeOperation="lighter",this.drawCircles()},drawCircles:function(){var t=this.ctx.canvas.width,i=this.ctx.canvas.height;this.ctx.clearRect(0,0,t,i),this.ctx.beginPath(),this.ctx.strokeStyle="rgb(".concat(this.colors[0][0],", \n                                  ").concat(this.colors[0][1],", \n                                  ").concat(this.colors[0][2],")"),this.ctx.rect(t/2-this.size,i/2-this.size,2*this.size,2*this.size),this.ctx.lineWidth=this.size/2,this.ctx.stroke(),this.ctx.beginPath(),this.ctx.fillStyle="rgb(".concat(this.colors[1][0],", \n                                ").concat(this.colors[1][1],", \n                                ").concat(this.colors[1][2],")"),this.ctx.fillRect(t/2-this.size/2,i/2-this.size/2,this.size,this.size),this.$emit("setColors",this.colors),this.$emit("setSize",this.size)}}}),C=x,b=(e("29f2"),Object(f["a"])(C,_,w,!1,null,"aa3e6f4e",null)),y=b.exports,I=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"container"},[e("h3",[t._v("Configure the Viewing Distance and Units")]),e("div",{staticClass:"text-holder"},[e("p",[t._v("In meters, the distance between the patient and the screen is:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.dist,expression:"dist"}],attrs:{placeholder:"distance"},domProps:{value:t.dist},on:{input:[function(i){i.target.composing||(t.dist=i.target.value)},t.updateDistance]}})]),e("div",{staticClass:"text-holder"},[e("p",[t._v("For measurements, show results in:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.units,expression:"units"}],attrs:{type:"radio",id:"degrees",value:"0"},domProps:{checked:t._q(t.units,"0")},on:{change:[function(i){t.units="0"},t.updateUnits]}}),e("label",{attrs:{for:"degrees"}},[t._v("Degrees")]),e("br"),e("input",{directives:[{name:"model",rawName:"v-model",value:t.units,expression:"units"}],attrs:{type:"radio",id:"pd",value:"1"},domProps:{checked:t._q(t.units,"1")},on:{change:[function(i){t.units="1"},t.updateUnits]}}),e("label",{attrs:{for:"pd"}},[t._v("Prism Dioptres")])])])},P=[],D={props:["distIn","unitsIn"],data:function(){return{dist:null,units:null}},mounted:function(){this.dist=this.distIn,this.units=this.unitsIn},methods:{updateDistance:function(){this.$emit("setDistance",this.dist)},updateUnits:function(){this.$emit("setUnits",this.units)}}},z=D,S=(e("d0dd"),Object(f["a"])(z,I,P,!1,null,"4e6771d0",null)),k=S.exports,T={components:{PPI:g,Colors:y,Distance:k},props:["ppiIn","sizeIn","colorsIn","distIn","unitsIn"],data:function(){return{ppi:null,colors:[[0,128,0],[128,0,0]],size:null,dist:null,units:null,view:1}},mounted:function(){this.ppi=this.ppiIn,this.size=this.sizeIn,null!==this.colorsIn&&(this.colors=this.colorsIn),this.dist=this.distIn,this.units=this.unitsIn},methods:{canContinue:function(){return 1==this.view&&null!==this.ppi&&this.ppi>0||(2==this.view||3==this.view&&null!==this.dist&&this.dist>0&&null!==this.units)},updatePPI:function(t){this.ppi=t,this.$emit("setPPI",t),this.ppi>0&&null!==this.ppi?this.canContinue[0]=!0:this.canContinue[0]=!1},updateSize:function(t){this.size=t,this.$emit("setSize",t)},updateColors:function(t){this.colors=t,this.$emit("setColors",t)},updateDist:function(t){this.dist=t,this.$emit("setDistance",t),this.distAndUnitsDone()},updateUnits:function(t){this.units=t,this.$emit("setUnits",t),this.distAndUnitsDone()},distAndUnitsDone:function(){null!==this.units&&null!==this.dist&&this.dist>0?this.canContinue[2]=!0:this.canContinue[2]=!1},calibrationDone:function(){this.$emit("calibrationDone")}}},A=T,M=(e("7f4a"),Object(f["a"])(A,c,d,!1,null,null,null)),E=M.exports,$=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"container"},[t.showTool?t._e():e("div",{staticClass:"grid-container"},[e("div",{staticClass:"button top-left",on:{click:function(i){t.confirmDelete=!0}}},[t._v(" Delete Entry ")]),t.dataAll.name&&t.dataAll.name.length>0?e("div",{staticClass:"button top-right",on:{click:t.closeDetailView}},[t._v(" Save ")]):t._e(),e("input",{directives:[{name:"model",rawName:"v-model",value:t.dataAll.name,expression:"dataAll.name"}],staticClass:"text",attrs:{placeholder:"name this dataset"},domProps:{value:t.dataAll.name},on:{input:function(i){i.target.composing||t.$set(t.dataAll,"name",i.target.value)}}}),t.showPrefs?e("div",{staticClass:"overlay"}):t._e(),t.showPrefs?e("div",{staticClass:"preferences-container"},[e("Preferences",{attrs:{dataIn:t.dataAll,ppi:t.ppi},on:{setPrefs:t.savePreferences}})],1):t._e(),t.dataAll.name&&t.dataAll.name.length>0?e("div",[e("div",{staticClass:"button-container"},[e("div",{staticClass:"button padded",on:{click:function(i){return t.launchTool()}}},[t._v("Launch Tool")]),e("p",[t._v("(while the tool is open, press any keyboard key to exit)")]),e("div",{staticClass:"button split",on:{click:function(i){t.showPrefs=!0}}},[t._v("Preferences")]),e("div",{staticClass:"button split",on:{click:function(i){t.showResults=!t.showResults}}},[t._v(" "+t._s(t.showResults?"Hide Results":"Show Results")+" ")])]),t.showResults&&void 0!==t.dataAll.data?e("div",{staticClass:"data-container"},[e("div",{staticStyle:{display:"inline-block"}},t._l(3,(function(i){return e("div",{key:i,staticClass:"data-row"},t._l(3,(function(s){return e("div",{key:s,staticClass:"data-entry",on:{click:function(e){return t.launchTool(i-1,s-1)}}},[e("p",{staticClass:"corner-label"},[t._v(t._s(3*(i-1)+s))]),e("div",{staticClass:"show-data-values"},[void 0!==t.dataAll.data[i-1][s-1].hu?e("p",{staticClass:"data"},[t._v(" H: "+t._s(t.dataAll.data[i-1][s-1].hu)+" "),0==t.dataAll.units?e("span",[t._v("°")]):e("span",[e("sup",[t._v("Δ")])])]):e("p",{staticClass:"data"},[t._v(" H: ")]),void 0!==t.dataAll.data[i-1][s-1].vu?e("p",{staticClass:"data"},[t._v(" V: "+t._s(t.dataAll.data[i-1][s-1].vu)+" "),0==t.dataAll.units?e("span",[t._v("°")]):e("span",[e("sup",[t._v("Δ")])])]):e("p",{staticClass:"data"},[t._v(" V: ")]),void 0!==t.dataAll.data[i-1][s-1].rr?e("p",{staticClass:"data"},[t._v(" T: "+t._s(t.dataAll.data[i-1][s-1].rr-t.dataAll.data[i-1][s-1].gr)+"° ")]):e("p",{staticClass:"data"},[t._v(" T: ")])])])})),0)})),0),e("p",{staticClass:"data"},[t._v("V is the measured vertical offset in "+t._s(0==t.dataAll.units?"degrees":"prism dioptres")+".")]),e("p",{staticClass:"data"},[t._v("H is the measured horizontal offset in "+t._s(0==t.dataAll.units?"degrees":"prism dioptres")+".")]),e("p",{staticClass:"data",staticStyle:{"padding-bottom":"20px"}},[t._v("T is the torsion measurements in degrees.")])]):t._e(),t.confirmDelete?e("div",{staticClass:"overlay"}):t._e(),t.confirmDelete?e("div",{staticClass:"confirm-popup"},[e("h3",[t._v("Confirm Delete")]),e("p",[t._v("Are you sure you want to delete this entry and all its data? This can't be undone.")]),e("div",{staticClass:"button delete-buttons cancel",on:{click:function(i){t.confirmDelete=!1}}},[t._v(" Cancel ")]),e("div",{staticClass:"button delete-buttons yes",on:{click:t.deleteEntry}},[t._v(" Yes ")])]):t._e()]):e("div",[e("p",[t._v("You must name this dataset before you can make measurements.")])])]),t._v(" "),void 0!==t.dataAll.data&&t.showTool?e("div",{staticClass:"tool-container"},t._l(3,(function(i){return e("div",{key:i,staticClass:"tool-row"},t._l(3,(function(s){return e("div",{key:s,staticClass:"tool-entry"},[e("Tool",{attrs:{ppiIn:t.ppi,ind:{row:i-1,col:s-1},data:t.dataAll,showMeta:!1,config:!1}})],1)})),0)})),0):t._e()])},O=[],U=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{ref:"cont_"+t.ind.row+"_"+t.ind.col,staticClass:"entry-container"},[e("canvas",{ref:"canvas_"+t.ind.row+"_"+t.ind.col,attrs:{id:"canvas"}},[t._v(" Your browser doesn't support HTML canvas. Please upgrade to a newer browser. ")]),t.showMeta?e("div",{staticClass:"footer"},[e("span",{staticClass:"footer"},[t._v(" H="+t._s(t.hu)),0==t.data.units?e("span",[t._v("°")]):e("span",[e("sup",[t._v("Δ")])])]),e("span",{staticClass:"footer"},[t._v(" V="+t._s(t.vu)),0==t.data.units?e("span",[t._v("°")]):e("span",[e("sup",[t._v("Δ")])])]),e("span",{staticClass:"footer"},[t._v(" T="+t._s((t.red.r-t.green.r)%180)+"° ")])]):t._e()])},N=[],j=(e("cb29"),e("d3b7"),e("ddb0"),{props:["ind","ppiIn","data","showMeta","config"],data:function(){return{canvas:null,ctx:null,CLICK_DIST:0,red:{r:0},green:{r:0},startX:0,startY:0,vu:0,hu:0,dragging:!1,gc:0,rc:1,ppi:null,dist:null,entries:null}},mounted:function(){this.config?this.entries=this.data.offset:this.entries=this.data.data,this.ppi=parseInt(this.ppiIn),this.setupCanvas(),this.init()},methods:{setupCanvas:function(){var t="canvas_"+this.ind.row+"_"+this.ind.col;this.canvas=this.$refs[t],this.canvas.onmousedown=this.mouseDown,this.canvas.onmousemove=this.mouseMove,this.canvas.onmouseup=this.mouseUp,this.canvas.onmouseout=this.mouseUp,this.canvas.ontouchstart=this.touchDown,this.canvas.ontouchmove=this.touchMove,this.canvas.ontouchend=this.mouseUp,this.canvas.ontouchcancel=this.mouseUp,this.canvas.onwheel=this.scroll,window.onresize=this.init,this.ctx=this.canvas.getContext("2d")},init:function(){if(this.resizeCanvas(),this.red.x=this.ctx.canvas.width/2,this.red.y=this.ctx.canvas.height/2,this.red.r=0,void 0!==this.entries[this.ind.row][this.ind.col].v&&(this.red.r=this.entries[this.ind.row][this.ind.col].rr),void 0!==this.data.offset&&void 0!==this.data.offset[0][0].h&&(this.red.x-=this.data.offset[0][0].h,this.red.y+=this.data.offset[0][0].v,void 0===this.entries[this.ind.row][this.ind.col].v&&(this.red.r=this.data.offset[0][0].rr)),void 0===this.entries[this.ind.row][this.ind.col].v){this.entries[this.ind.row][this.ind.col]={};var t=0,i=0,e=0;this.config||(t=Math.floor(Math.random()*this.data.size)-this.data.size/2,i=Math.floor(Math.random()*this.data.size)-this.data.size/2,e=Math.floor(90*Math.random())-45),this.green.x=this.ctx.canvas.width/2+t,this.green.y=this.ctx.canvas.height/2+i,this.green.r=0+e}else this.green.x=this.red.x+this.entries[this.ind.row][this.ind.col].h,this.green.y=this.red.y-this.entries[this.ind.row][this.ind.col].v,this.green.r=this.entries[this.ind.row][this.ind.col].gr;this.updateData(),this.drawCircles()},resizeCanvas:function(){var t="cont_"+this.ind.row+"_"+this.ind.col,i=this.$refs[t];void 0!==i&&(this.ctx.canvas.width=i.clientWidth,this.ctx.canvas.height=i.clientHeight)},drawCircles:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.globalCompositeOperation="source-over",this.ctx.beginPath(),this.ctx.translate(this.red.x,this.red.y),this.ctx.rotate(this.red.r*Math.PI/180),this.ctx.arc(0,0,this.data.size/1.25,0,2*Math.PI),this.ctx.fillStyle="rgb(".concat(this.data.colors[this.rc][0],", \n                               ").concat(this.data.colors[this.rc][1],", \n                               ").concat(this.data.colors[this.rc][2],")"),this.ctx.fill(),this.ctx.beginPath(),this.ctx.strokeStyle="black",this.ctx.lineWidth=this.data.size/2.5,this.ctx.moveTo(0,-this.data.size),this.ctx.lineTo(0,this.data.size),this.ctx.stroke(),this.ctx.rotate(-this.red.r*Math.PI/180),this.ctx.translate(-this.red.x,-this.red.y),this.ctx.globalCompositeOperation="lighter",this.ctx.beginPath(),this.ctx.translate(this.green.x,this.green.y),this.ctx.rotate(this.green.r*Math.PI/180),this.ctx.arc(0,0,this.data.size,0,2*Math.PI),this.ctx.moveTo(0,-this.data.size),this.ctx.lineTo(0,this.data.size),this.ctx.strokeStyle="rgb(".concat(this.data.colors[this.gc][0],", \n                                 ").concat(this.data.colors[this.gc][1],", \n                                 ").concat(this.data.colors[this.gc][2],")"),this.ctx.lineWidth=this.data.size/2.5,this.ctx.stroke(),this.ctx.rotate(-this.green.r*Math.PI/180),this.ctx.translate(-this.green.x,-this.green.y)},mouseDown:function(t){t.preventDefault(),t.stopPropagation(),this.dragging=!0,this.startX=parseInt(t.clientX),this.startY=parseInt(t.clientY)},touchDown:function(t){t.preventDefault(),t.stopPropagation(),t.touches.length>=1&&(this.dragging=!0),this.startX=parseInt(t.touches[0].clientX),this.startY=parseInt(t.touches[0].clientY)},move:function(t,i){var e=t-this.startX,s=i-this.startY;this.startX=t,this.startY=i,this.dragging&&(this.config?(this.red.x+=e,this.red.y+=s):(this.green.x+=e,this.green.y+=s),this.drawCircles(),this.updateData())},mouseMove:function(t){t.preventDefault(),t.stopPropagation();var i=parseInt(t.clientX),e=parseInt(t.clientY);this.move(i,e)},touchMove:function(t){t.preventDefault(),t.stopPropagation();var i=parseInt(t.touches[0].clientX),e=parseInt(t.touches[0].clientY);this.move(i,e)},mouseUp:function(t){t.preventDefault(),t.stopPropagation(),this.dragging=!1},scroll:function(t){t.preventDefault(),t.stopPropagation(),t.deltaY<0?this.config?this.red.r-=1:this.green.r-=1:this.config?this.red.r+=1:this.green.r+=1,this.drawCircles(),this.updateData()},updateData:function(){var t=this.red.y-this.green.y,i=-1*(this.red.x-this.green.x);this.entries[this.ind.row][this.ind.col].v=t,this.entries[this.ind.row][this.ind.col].h=i;var e=t/this.ppi*25.4,s=i/this.ppi*25.4;if(0==this.data.units){var n=Math.atan(e/this.data.dist/1e3);this.vu=Math.round(18e3*n/Math.PI)/100;var a=Math.atan(s/this.data.dist/1e3);this.hu=Math.round(18e3*a/Math.PI)/100}else this.vu=Math.round(e/this.data.dist*10)/100,this.hu=Math.round(s/this.data.dist*10)/100;this.entries[this.ind.row][this.ind.col].vu=this.vu,this.entries[this.ind.row][this.ind.col].hu=this.hu,this.entries[this.ind.row][this.ind.col].gr=this.green.r,this.entries[this.ind.row][this.ind.col].rr=this.red.r}}}),R=j,H=(e("0091"),Object(f["a"])(R,U,N,!1,null,"2296fafd",null)),Y=H.exports,V=function(){var t=this,i=t.$createElement,e=t._self._c||i;return null!=t.data?e("div",{staticClass:"container"},[e("div",{staticClass:"banner"},[e("span",{staticClass:"title"},[t._v("Preferences")]),e("div",{staticClass:"button right",on:{click:t.savePrefs}},[t._v(" Done ")])]),e("div",{staticClass:"text-holder"},[e("span",{staticStyle:{"margin-right":"5px"}},[t._v("Patient viewing distance (meters):")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.dist,expression:"data.dist"}],class:{error:t.distError},attrs:{type:"text",placeholder:"distance"},domProps:{value:t.data.dist},on:{input:[function(i){i.target.composing||t.$set(t.data,"dist",i.target.value)},t.updateDist]}})]),e("div",{staticClass:"text-holder"},[e("span",{staticStyle:{"margin-right":"15px"}},[t._v("Units:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.units,expression:"data.units"}],attrs:{name:"unit",type:"radio",id:"degrees",value:"0"},domProps:{checked:t._q(t.data.units,"0")},on:{change:[function(i){return t.$set(t.data,"units","0")},t.updateUnits]}}),e("label",{staticStyle:{"margin-right":"15px"},attrs:{for:"degrees"}},[t._v("Degrees")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.units,expression:"data.units"}],attrs:{name:"unit",type:"radio",id:"pd",value:"1"},domProps:{checked:t._q(t.data.units,"1")},on:{change:[function(i){return t.$set(t.data,"units","1")},t.updateUnits]}}),e("label",{attrs:{for:"pd"}},[t._v("Prism Dioptres")])]),e("div",[e("div",{staticClass:"text-holder"},[e("span",{staticStyle:{"margin-right":"15px"}},[t._v("Size:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.tempSize,expression:"tempSize"}],attrs:{type:"range",min:"10",max:"200"},domProps:{value:t.tempSize},on:{input:t.setSize,__r:function(i){t.tempSize=i.target.value}}})])]),e("div",{staticClass:"tool-container",style:{width:t.toolWidth+"px",height:t.toolHeight+"px"}},[e("Tool",{ref:"tool",attrs:{ppiIn:t.ppi,ind:{row:0,col:0},data:t.data,showMeta:!0,config:!0}})],1),t._l(t.data.colors,(function(i,s){return e("div",{key:s,staticClass:"slide-cont"},[e("h3",[t._v(t._s(0==s?"Outer":"Inner")+" Circle RGB")]),t._l(3,(function(s){return e("div",{key:s},[e("p",[t._v(t._s(t.colorNames[s-1])+" Component:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i[s-1],expression:"color[j-1]"}],staticClass:"slider",attrs:{type:"range",min:"0",max:"255"},domProps:{value:i[s-1]},on:{input:function(i){return t.setColors()},__r:function(e){return t.$set(i,s-1,e.target.value)}}})])}))],2)}))],2):t._e()},W=[],X={components:{Tool:Y},props:["dataIn","ppi"],data:function(){return{data:null,toolWidth:0,toolHeight:0,tempSize:null,colorNames:["Red","Green","Blue"],distError:!1}},mounted:function(){this.setToolSize(),this.data=this.dataIn,void 0==this.data.offset&&(this.data.offset=[[{}]]),this.tempSize=this.data.size},methods:{savePrefs:function(){parseFloat(this.data.dist)>0&&this.$emit("setPrefs")},setToolSize:function(){this.toolWidth=window.innerWidth/3,this.toolHeight=window.innerHeight/3},setSize:function(){this.data.size=parseInt(this.tempSize),this.$refs.tool.drawCircles()},setColors:function(){this.$refs.tool.drawCircles()},updateDist:function(){var t=parseFloat(this.data.dist);t>0?(this.distError=!1,this.data.dist=t,this.$refs.tool.updateData()):this.distError=!0},updateUnits:function(){this.$refs.tool.updateData()}}},F=X,L=(e("6a34"),Object(f["a"])(F,V,W,!1,null,"2d9f0740",null)),q=L.exports,B={components:{Tool:Y,Preferences:q},props:["dataIn","ppi","sizeIn","colorsIn","distIn","unitsIn"],data:function(){return{dataAll:{},confirmDelete:!1,ind:{},showTool:!1,smallScreen:!1,forceDesktop:!1,showPrefs:!1,showResults:!1}},mounted:function(){document.onkeyup=this.closeTool,this.dataAll=this.dataIn,void 0===this.dataAll.size&&(this.dataAll.size=this.sizeIn),void 0===this.dataAll.colors&&(this.dataAll.colors=this.colorsIn),void 0===this.dataAll.dist&&(this.dataAll.dist=this.distIn),void 0===this.dataAll.unitsIn&&(this.dataAll.units=this.unitsIn),void 0===this.dataAll.invert&&(this.dataAll.invert=!1),window.onresize=this.configureLayout,this.configureLayout()},methods:{configureLayout:function(){},deleteEntry:function(){this.$emit("deleteEntry")},closeDetailView:function(){this.$emit("closeDetailView")},launchTool:function(){this.showTool=!0},closeTool:function(){this.showTool=!1},savePreferences:function(){this.showPrefs=!1}}},G=B,J=(e("7a1b"),Object(f["a"])(G,$,O,!1,null,"1a1a7b8b",null)),K=J.exports,Q={components:{Calibrate:E,DataDetails:K},data:function(){return{calibrated:!1,calibrating:!1,ppi:null,colors:null,size:null,dist:null,units:null,invertColor:!1,data:[],currentIndex:null,currentData:null,dataDetails:!1,cname:"cal"}},mounted:function(){this.loadCalibration()},computed:{dataReversed:function(){return Object(l["a"])(this.data).reverse()}},methods:{calibrationEnded:function(){this.calibrating=!1,null!==this.ppi&&null!==this.colors&&null!==this.size&&null!==this.dist&&null!==this.units&&(this.calibrated=!0,this.saveCalibration())},addDataEntry:function(){var t={name:"",data:[[{},{},{}],[{},{},{}],[{},{},{}]]};this.data.push(t),this.showDataDetails(this.data.length-1)},showDataDetails:function(t){this.currentIndex=t,this.currentData=this.data[t],this.dataDetails=!0},deleteCurrentEntry:function(){this.data.splice(this.currentIndex,1),this.dataDetails=!1},loadCalibration:function(){var t=null;if("undefined"!==typeof Storage)t=JSON.parse(localStorage.getItem("cal"));else if(document.cookie.length>0){var i=decodeURIComponent(document.cookie);t=JSON.parse(i.split("=")[1])}null!==t&&(this.ppi=parseFloat(t.ppi),this.colors=t.colors,this.size=parseInt(t.size),this.dist=parseFloat(t.dist),this.units=t.units,this.calibrated=!0)},saveCalibration:function(){var t={};t.ppi=this.ppi,t.colors=this.colors,t.size=this.size,t.dist=this.dist,t.units=this.units;var i=JSON.stringify(t);if("undefined"!==typeof Storage)localStorage.setItem("cal",i);else{i=encodeURIComponent(JSON.stringify(i));var e=new Date;e.setTime(e.getTime()+864e8);var s="expires="+e.toUTCString();document.cookie="cal="+i+";"+s+";samesite=Strict;"}},downloadData:function(){var t=new Date,i="Downloaded: "+t+"\n\n",e=0==this.units?"degrees":"prism dioptres";i+="H is the horizontal offset in "+e+".\n",i+="V is the vertical offset in "+e+".\n\n",i+="Tr is the torsion for the red square in degrees.\n",i+="Tg is the torsion for the green square in degrees.\n\n",i+="Viewing distance was: "+this.dist+" meters.\n\n\n";for(var s=this.data,n=0;n<s.length;n++)for(var a=0;a<s[n].data.length;a++)for(var o=0;o<s[n].data[a].length;o++)s[n].data[a][o].vu=void 0===s[n].data[a][o].vu?"-":s[n].data[a][o].vu,s[n].data[a][o].hu=void 0===s[n].data[a][o].hu?"-":s[n].data[a][o].hu,s[n].data[a][o].rr=void 0===s[n].data[a][o].rr?"-":s[n].data[a][o].rr,s[n].data[a][o].gr=void 0===s[n].data[a][o].gr?"-":s[n].data[a][o].gr;for(var r=0;r<s.length;r++){i+="Measurement name: "+s[r].name+"\n",i+="".padEnd(49,"-")+"\n";for(var l=0;l<s[r].data.length;l++)i+="|"+(" H: "+s[r].data[l][0].hu).padEnd(15)+"|"+(" H: "+s[r].data[l][1].hu).padEnd(15)+"|"+(" H: "+s[r].data[l][2].hu).padEnd(15)+"|\n",i+="|"+(" V: "+s[r].data[l][0].vu).padEnd(15)+"|"+(" V: "+s[r].data[l][1].vu).padEnd(15)+"|"+(" V: "+s[r].data[l][2].vu).padEnd(15)+"|\n",i+="|"+(" Tr: "+s[r].data[l][0].rr).padEnd(15)+"|"+(" Tr: "+s[r].data[l][1].rr).padEnd(15)+"|"+(" Tr: "+s[r].data[l][2].rr).padEnd(15)+"|\n",i+="|"+(" Tg: "+s[r].data[l][0].gr).padEnd(15)+"|"+(" Tg: "+s[r].data[l][1].gr).padEnd(15)+"|"+(" Tg: "+s[r].data[l][2].gr).padEnd(15)+"|\n",i+="".padEnd(49,"-")+"\n";i+="\n\n"}var c=document.createElement("a");c.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(i)),c.setAttribute("download","data.txt"),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c)}}},Z=Q,tt=(e("184c"),e("f19d"),Object(f["a"])(Z,o,r,!1,null,"aa2d54a8",null)),it=tt.exports,et={name:"App",components:{Home:it},data:function(){return{view:1}},mounted:function(){},methods:{}},st=et,nt=(e("034f"),Object(f["a"])(st,n,a,!1,null,null,null)),at=nt.exports;s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(at)}}).$mount("#app")},"62c6":function(t,i,e){},6622:function(t,i,e){},"6a34":function(t,i,e){"use strict";e("01d4")},"7a1b":function(t,i,e){"use strict";e("d5a8")},"7f4a":function(t,i,e){"use strict";e("b37c")},"85ec":function(t,i,e){},b37c:function(t,i,e){},c6cb:function(t,i,e){},d0dd:function(t,i,e){"use strict";e("6622")},d5a8:function(t,i,e){},d729:function(t,i,e){},e34b:function(t,i,e){},f19d:function(t,i,e){"use strict";e("d729")}});
//# sourceMappingURL=app.ce0eabea.js.map